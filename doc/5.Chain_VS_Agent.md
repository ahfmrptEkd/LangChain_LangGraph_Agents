# 🔄 LangChain Chain vs Agent 완전 가이드

> LangChain에서 Chain과 Agent의 핵심 차이점과 선택 기준

## 📊 핵심 비교표

| 특성 | Chain | Agent |
|------|-------|-------|
| **실행 방식** | 하드코딩된 순차 실행 | 동적 의사결정 |
| **유연성** | 매우 낮음 | 매우 높음 |
| **예측 가능성** | 매우 높음 | 낮음 |
| **비용** | 예측 가능 | 예측 어려움 |
| **도구 선택** | 고정된 순서 | 지능적 선택 |
| **디버깅** | 쉬움 | 어려움 |
| **적응성** | 없음 | 높음 |

## 🔗 Chain (체인)

### 정의
**항상 하드코딩된 방식으로 순차적인 액션을 수행하는 구조**

### 특징
- **미리 정의된 고정된 경로**: 실행 순서가 완전히 고정됨
- **예측 가능한 실행**: 항상 동일한 순서로 동일한 단계를 거침
- **단순하고 직선적**: A → B → C → D 순서로 진행

### 예시 워크플로우
```
1. 첫 번째 단계: 웹 검색
2. 두 번째 단계: 내부 벡터 데이터베이스 텍스트 임베딩  
3. 추론
```

### Chain 사용 권장 상황
- ✅ **항상 동일한 플로우와 전략**을 기반으로 하는 경우
- ✅ **예측 가능한 비용**이 필요한 경우
- ✅ **단순하고 고정된 워크플로우**가 적합한 경우

## 🤖 Agent (에이전트)

### 정의
**언어 모델과 함께 추론 엔진을 사용하여 어떤 액션을 취할지 결정하는 구조**

### 특징
- **상황에 따라 다양한 도구를 선택적으로 사용**
- **결과에 따라 다른 경로를 선택**할 수 있음
- **동적이고 적응적인 접근**

### 🎯 Agent의 주요 장점

#### 1. **지능적 도구 선택**
- 도구의 설명을 기반으로 관련 정보를 얻기 위해 어떤 도구를 사용할지 결정
- 상황에 맞는 최적의 도구 조합 선택

#### 2. **동적 워크플로우**
- 액션을 수행하고 결과의 컨텍스트를 활용하여 다른 리소스에서 추가 정보를 검색
- **예시**: Google Search → Wikipedia → 추가 검증 → 최종 답변

#### 3. **반복적 개선**
- 결과를 확인하고 원하는 데이터를 얻기 위해 프로세스를 반복
- 중간 결과를 바탕으로 다음 단계를 조정

### Agent 사용 권장 상황
- ✅ **다양한 소스(도구)에서 정보를 결정**해야 하는 경우
- ✅ **복잡한 쿼리를 단순한 것들로 나누는 것**이 필요한 경우
- ✅ **상황에 따라 다른 접근 방식**이 필요한 경우

## 🚀 실제 적용 예시

### 고객 문의 처리 시나리오

**Chain 방식**:
```
고객 문의 수신 → 카테고리 분류 → 템플릿 응답 생성 → 답변 전송
```

**Agent 방식**:
```
고객 문의 수신 → 문의 내용 분석 → 필요한 정보 판단 
→ [FAQ 검색 / 제품 DB 조회 / 전문가 상담 / 이전 대화 분석] 
→ 맞춤형 답변 생성 → 고객 만족도 확인 → 필요시 추가 조치
```

### 데이터 분석 시나리오

**Chain 방식**:
```
데이터 입력 → 전처리 → 분석 → 리포트 생성
```

**Agent 방식**:
```
데이터 입력 → 데이터 특성 분석 → 적절한 분석 방법 선택 
→ [통계 분석 / 머신러닝 / 시각화 / 외부 데이터 보강] 
→ 결과 해석 → 추가 분석 필요 여부 판단 → 최종 리포트
```

## ⚠️ Agent 주의사항

### Agent의 비용 예측 어려움
- 일부 질문은 **하나의 도구 호출**로 답변될 수 있음
- 다른 질문들은 **포괄적인 도구 세트**를 사용할 수 있음
- 실행 시간과 리소스 사용량이 크게 달라질 수 있음

### 도구 순서의 중요성
- Agent가 **올바른 순서로 도구를 호출**하도록 명확하게 정의된 지침 필요
- 잘못된 순서는 비효율적이거나 잘못된 결과를 초래할 수 있음

## 💡 선택 가이드

### Chain을 선택하세요
- 프로세스가 항상 동일한 경우
- 비용과 시간이 예측 가능해야 하는 경우
- 단순하고 반복적인 작업인 경우

### Agent를 선택하세요
- 상황에 따라 다른 접근이 필요한 경우
- 복잡한 추론과 판단이 필요한 경우
- 사용자 맞춤형 서비스를 제공해야 하는 경우

## 🔧 Workflow (워크플로우)
*Chain과 Agent의 중간 형태로, 구조화된 프로세스에 조건부 분기를 추가한 패턴*

- **특징**: 미리 정의된 코드 경로 + 조건부 분기
- **활용**: 비즈니스 로직이 복잡하지만 완전한 자율성은 불필요한 경우

## 🧪 실제 RAG 구현에서의 차이점

### Chain RAG의 동작
```
사용자: "Hello, how are you?"
→ 항상 문서 검색 수행 (불필요함에도)
→ 검색 결과를 바탕으로 답변 생성
```

### Agent RAG의 동작  
```
사용자: "Hello, how are you?"
→ Agent 판단: "일반적인 인사, 검색 불필요"
→ 바로 답변 생성

사용자: "What is Task Decomposition?"  
→ Agent 판단: "문서 관련 질문, 검색 필요"
→ 검색 수행 → 결과 분석 → 답변 생성
```

### 🔍 실제 모니터링 결과
```
📊 Agent 활동 요약:
   • 일반 질문 - 총 단계: 1, 도구 호출: 0회
   • 문서 질문 - 총 단계: 3, 도구 호출: 1회  
   • 복잡한 질문 - 총 단계: 5+, 도구 호출: 2-3회
```

→ **실제로 비용이 질문 복잡도에 따라 크게 달라짐!**

## 📈 결론

- **Chain**: 예측 가능한 단순 파이프라인
- **Agent**: 지능적이고 적응적인 의사결정자

> 💡 **핵심 원칙**: 가장 간단한 솔루션(Chain)부터 시작하여 필요에 따라 복잡성을 추가하세요.

## 📚 참고 자료

- [Bright Inventions LangChain 에이전트 튜토리얼](https://brightinventions.pl/blog/introducing-langchain-agents-tutorial-with-example/)
- [Anthropic 효과적인 에이전트 구축 가이드](https://docs.anthropic.com/en/docs/build-with-claude/develop-agents)
- [LangChain 워크플로우 및 에이전트 튜토리얼](https://langchain-ai.github.io/langgraphjs/tutorials/workflows/)
